#include <math.h> 

/*--------------------------------------------------------------*/
double erf(double x)
/*--------------------------------------------------------------*/
{
  double ax,t,y;
  ax=fabs(x);
  if(ax>5.94) return x<0.0 ? -1.0 : 1.0;
  t=1.0/(1.0+0.5*ax);
  y= (-1.265512123484645+t*(2.413446064151486+t*(-9.923502804068758+
   t*(13.30227627857427+t*(-24.31939647870131+t*(23.69235092477504+
   t*(-22.19704395697156+t*(17.33962064613528+t*(-6.393856404424753+
   t*(6.048145478410007+t*(0.2817878807093651+t*(0.9389130912957599+
   t*0.08277140359981640))))))))))))/
   (1.0+t*(-1.116896502152423+t*(7.255249579620269+t*(-5.043436120037070+
   t*(17.24018785565654+t*(-6.152935277515339+t*(17.01615603408679+
   t*(-1.320849599715369+t*(7.600531901165844+t*(0.9298597410369911+
   t*(1.484046041424923+t*(0.2456375141642222+t*0.06979297013258348))))))))))));
  y=t*exp(-x*x+y);
  return x>=0.0 ? 1.0-y : -1.0+y;
}
 
/*--------------------------------------------------------------*/
double emgcum(double x)
/*--------------------------------------------------------------*
   TableCurve Function: C:\\Users\\Thunderobot\\Desktop\\curve_fitting\\emgcum.c Aug 18, 2023 11:50:13 AM 
   Test 
   X= Y 
   Y= X 
   Eqn# 8189  EMGCum(a,b,c,d,e) 
   r2=0.4496184545026582 
   r2adj=0.4471831379296611 
   StdErr=0.1113202070334846 
   Fstat=230.9845216480657 
   a= 2.462621417204716 
   b= -851.452230198572 
   c= 0.2802694937212452 
   d= 0.009167677317678643 
   e= 258.8403918098462 
   Constraints: d>0,e<>0 
 *--------------------------------------------------------------*/
{
  double y;
  double n; 
  n=(x-0.2802694937212452)/(1.4142135623730950488*
    0.009167677317678643);
  y=2.462621417204716+0.5*(-851.4522301985720)*(1.0+
    erf(n)-(258.8403918098462/
    fabs(258.8403918098462)+erf(n-0.009167677317678643/
    (1.4142135623730950488*258.8403918098462)))*
    exp(0.009167677317678643*0.009167677317678643/(2.0*
    258.8403918098462*258.8403918098462)+
    (0.2802694937212452-x)/258.8403918098462));
  return(y);
}
 
